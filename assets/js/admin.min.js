!function(e){function t(t){for(var a,n,o=t[0],p=t[1],l=t[2],c=0,m=[];c<o.length;c++)n=o[c],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&m.push(r[n][0]),r[n]=0;for(a in p)Object.prototype.hasOwnProperty.call(p,a)&&(e[a]=p[a]);for(u&&u(t);m.length;)m.shift()();return i.push.apply(i,l||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],a=!0,o=1;o<s.length;o++){var p=s[o];0!==r[p]&&(a=!1)}a&&(i.splice(t--,1),e=n(n.s=s[0]))}return e}var a={},r={1:0},i=[];function n(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=a,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(s,a,function(t){return e[t]}.bind(null,a));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var o=window.pluginWebpack=window.pluginWebpack||[],p=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=p;i.push([135,0]),s()}({0:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(s(27)),r=i(s(60));function i(e){return e&&e.__esModule?e:{default:e}}a.default.use(r.default);t.default=new r.default.Store({state:{importOffset:0,importLimit:0,uploadedFileId:null,csvLength:1,stepIdCount:1,varIdCount:1,import:{error:!1,complete:!1,progress:""},steps:[{id:"create_post_1",action:"create_post",getMap:[{}],setMap:[{left:"post_type"}]}],csvFields:[],customVars:[{name:"Custom Var",id:1,code:""}]},getters:{customVars:function(e){return e.customVars.map((function(e){return{key:e.name,value:e.id}}))},stepIds:function(e){return e.steps.map((function(e){return e.id}))},jsonVars:function(e){return JSON.stringify(e.customVars)},jsonSteps:function(e){return JSON.stringify(e.steps)}},mutations:{updateOffset:function(e,t){e.importOffset=t},updateLimit:function(e,t){e.importLimit=t},incrementVarId:function(e){e.varIdCount++},setFileId:function(e,t){e.uploadedFileId=t},updateCsvFields:function(e,t){e.csvFields=t},addVar:function(e,t){e.customVars.splice(t+1,0,{id:"",map:[{}]})},removeVar:function(e,t){e.customVars.splice(t,1)},addVarSegment:function(e,t){e.customVars[t.varIndex].splice(t.segmentLength+1,0,{})},removeVarSegment:function(e,t){},stepPresets:function(e,t){var s=t.index,a=[{}],r=[{}];if(e.stepIdCount++,t.setParams){var i=Object.keys(t.setParams).filter((function(e){return/(required|recommended)/.test(t.setParams[e])}));i.length>0&&(a=[],i.forEach((function(e){a.push({left:e})})))}if(t.getParams){var n=Object.keys(t.getParams).filter((function(e){return-1!==t.getParams[e].indexOf("required")}));n.length>0&&(r=[],n.forEach((function(e){r.push({left:e})})))}e.steps[s].setMap=a,e.steps[s].getMap=r,e.steps[s].id=e.steps[s].action+"_"+e.stepIdCount},addStep:function(e,t){e.stepIdCount++,e.steps.splice(t+1,0,{id:"create_post_"+e.stepIdCount,action:"create_post",getMap:[{}],setMap:[{left:"post_type"}]})},removeStep:function(e,t){e.steps.splice(t,1)},addMapRow:function(e,t){t.isGetter?e.steps[t.stepIndex].getMap.splice(t.mapLength+1,0,{}):e.steps[t.stepIndex].setMap.splice(t.mapLength+1,0,{})},deleteMapRow:function(e,t){t.isGetter?e.steps[t.stepIndex].getMap.splice(t.mapIndex,1):e.steps[t.stepIndex].setMap.splice(t.mapIndex,1)}}})},133:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CsvToArray=function(e,t){t=t||",";for(var s=new RegExp("(\\"+t+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+t+"\\r\\n]*))","gi"),a=[[]],r=null;r=s.exec(e);){var i,n=r[1];n.length&&n!==t&&a.push([]),i=r[2]?r[2].replace(new RegExp('""',"g"),'"'):r[3],a[a.length-1].push(i)}return a}},134:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActions=void 0;var a=s(83),r=s(9),i=[{id:"create_post",displayName:"create post",setParams:a.createPost},{id:"create_user",displayName:"create user",setParams:a.createUser},{id:"update_user",displayName:"update user",getParams:a.getUser,setParams:a.updateUser},{id:"update_post",displayName:"update post",getParams:a.getPost,setParams:a.createPost},{id:"add_post_terms",displayName:"add categories, tags, etc., to post",getParams:a.getPost,setParams:{custom:"taxonomies"}},{id:"add_post_meta",displayName:"add post meta",getParams:a.getPost,setParams:{null:"null"}},{id:"add_user_meta",displayName:"add user meta",getParams:a.getUser,setParams:{null:"null"}},{id:"add_acf",displayName:"add acf data",getParams:a.getPost,setParams:{custom:"acfFields"}}];t.getActions=async function(){var e=await r.WpApi.importParams();return i.map((function(t){var s=t;return void 0!==t.setParams&&void 0!==t.setParams.custom&&(s.setParams=e[t.setParams.custom]),s}))}},135:function(e,t,s){"use strict";var a=p(s(27)),r=p(s(338)),i=p(s(137)),n=p(s(182)),o=p(s(84));function p(e){return e&&e.__esModule?e:{default:e}}a.default.component("v-select",o.default),a.default.config.productionTip=!1,new a.default({el:"#vue-admin-app",router:i.default,render:function(e){return e(r.default)}}),(0,n.default)("ifm-importer")},137:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(s(27)),r=o(s(59)),i=o(s(337)),n=o(s(339));function o(e){return e&&e.__esModule?e:{default:e}}a.default.use(r.default),t.default=new r.default({routes:[{path:"/",name:"Import",component:i.default},{path:"/settings",name:"Settings",component:n.default}]})},179:function(e,t,s){"use strict";var a=function(e){return e&&e.__esModule?e:{default:e}}(s(36));s(180),a.default.defineSimpleMode("IfmScript",{start:[{regex:/{{([\w|\s|-|\.]+?)}}/,token:"variable"},{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"string"},{regex:/(trim|toLower|toUpper|humanize|replace|htmlEncode|htmlDecode|titleize|formatDate)\(\)?/,token:"function",push:"args"},{regex:/[\{\[\(]/,indent:!0},{regex:/[\}\]\)]/,dedent:!0},{regex:/true|false|null|undefined/,token:"atom",next:"start"},{regex:/[-+\/*(==)!]+/,token:"operator",next:"start"}],args:[{regex:/{{([\w|\s|-|\.]+?)}}/,token:"variable_arg"},{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"string_arg"},{regex:/\)/,token:"function",pop:!0},{regex:/(trim|toLower|toUpper|capitalize|replace)\(\)?/,token:"function",push:"args"}],meta:{lineComment:"//"}})},181:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActionByName=function(e,t){return t.find((function(t){return t.id===e}))}},182:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=jQuery,s=t("#toplevel_page_"+e),a=window.location.href,r=a.substr(a.indexOf("admin.php"));s.on("click","a",(function(){var e=t(this);t("ul.wp-submenu li",s).removeClass("current"),e.hasClass("wp-has-submenu")?t("li.wp-first-item",s).addClass("current"):e.parents("li").addClass("current")})),t("ul.wp-submenu a",s).each((function(e,s){t(s).attr("href")!==r||t(s).parent().addClass("current")}))}},337:function(e,t,s){"use strict";s.r(t);var a=s(0),r=s.n(a),i=s(132),n=s.n(i),o=s(9),p=s(133),l={name:"FileUploader",props:["filetype","filedata"],data:()=>({file:{},uploadId:{},readyToSubmit:!1,leaveWarning:!1}),beforeMount(){window.addEventListener("beforeunload",e=>{this.leaveWarning&&(e.preventDefault(),e.returnValue="")})},methods:{previewFile(){(new FormData).append("file",this.file);let e=this;o.WpApi.media().file(this.file).create({title:"CSV Upload",description:"Csv Upload for Import"}).then((function(t){e.$emit("uploaded",t.id)}))},stageFile(){this.leaveWarning=!0,this.file=this.$refs.fileUpload.files[0],this.readyToSubmit=!0,this.previewFile()}}},u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("label",[e._v("\n    Upload Your CSV\n    "),s("input",{ref:"fileUpload",staticClass:"file-upload",attrs:{type:"file"},on:{change:function(t){return e.stageFile()}}})]),e._v(" "),s("br")])};u._withStripped=!0;var c=s(3),m=Object(c.a)(l,u,[],!1,null,null,null);m.options.__file="assets/src/components/FileUploader.vue";var d=m.exports,v={name:"StepsRaw",props:["summary"],computed:{steps:function(){return r.a.state.steps},vars:function(){return r.a.state.customVars}}},f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return[]!==e.steps?s("details",{staticClass:"raw-json"},[s("Summary",[e._v(e._s(e.summary))]),e._v(" "),s("h4",{staticStyle:{margin:"20px"}},[e._v("Custom Vars")]),e._v(" "),s("pre",[e._v(e._s(e.vars))]),e._v(" "),s("h4",{staticStyle:{margin:"20px"}},[e._v("Steps")]),e._v(" "),s("pre",[e._v(e._s(e.steps))])],1):e._e()};f._withStripped=!0;var _=Object(c.a)(v,f,[],!1,(function(e){s(341)}),null,null);_.options.__file="assets/src/components/stepper/StepsRaw.vue";var g=_.exports,h=s(56),w=(s(176),s(179),s(57)),y={components:{codemirror:h.codemirror},props:{index:{type:Number}},data(){return{ref:this.index+1,fieldsToggled:!1,formatsToggled:!1,dateFormats:w.dateFormats,stringFunctions:w.stringFunctions,customVarPreview:null,previewRecordIndex:1,cmOptions:{tabSize:4,mode:"IfmScript",theme:"default",lineNumbers:!0,line:!0}}},methods:{async previewCustomVar(){this.customVarPreview=null,this.customVarPreview=await o.WpApi.previewCustomVar().param("upload_id",r.a.state.uploadedFileId).param("record_index",Number(this.previewRecordIndex)-1).param("var_code",this.customVar.code)},insert(e){this.codemirror.replaceSelection(e),this.codemirror.focus(),this.fieldsToggled=!1},insertFormat(e){this.codemirror.replaceSelection('"'+e+'"'),this.codemirror.focus(),this.formatsToggled=!1},toggleFields(){this.fieldsToggled=!this.fieldsToggled},toggleFormats(){this.formatsToggled=!this.formatsToggled},onCmReady(e){},onCmFocus(e){},onCmCodeChange(e){r.a.state.customVars[this.index].code=e}},computed:{customVar(){return r.a.state.customVars[this.index]},csvFields:{get:()=>r.a.state.csvFields},codemirror(){return this.$refs.myCm.codemirror}}},C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"string-editor-wrapper"},[s("div",{staticClass:"string-editor-header"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.csvFields.length>0,expression:"csvFields.length > 0"}],staticClass:"csv-value-dropdown"},[s("button",{staticClass:"button-secondary",on:{click:e.toggleFields}},[e._v("\n        Csv Value\n      ")]),e._v(" "),s("table",{directives:[{name:"show",rawName:"v-show",value:e.fieldsToggled,expression:"fieldsToggled"}],staticClass:"form-table"},e._l(e.csvFields,(function(t,a){return s("tr",{key:a,attrs:{valign:"top"}},[s("td",{attrs:{scope:"row"},on:{click:function(s){return e.insert("{{"+t+"}}")}}},[e._v("\n            "+e._s(t)+"\n          ")])])})),0)]),e._v(" "),e._l(e.stringFunctions,(function(t,a){return s("button",{key:a,staticClass:"button-secondary",attrs:{title:t.description},on:{click:function(s){return e.insert(t.insert)}}},[e._v("\n      "+e._s(t.name)+"\n    ")])})),e._v(" "),s("div",{staticClass:"csv-value-dropdown"},[s("button",{staticClass:"button-secondary",on:{click:e.toggleFormats}},[e._v("\n        Date Formats\n      ")]),e._v(" "),s("table",{directives:[{name:"show",rawName:"v-show",value:e.formatsToggled,expression:"formatsToggled"}],staticClass:"form-table"},e._l(e.dateFormats,(function(t,a){return s("tr",{key:a,attrs:{valign:"top"}},[s("td",{attrs:{scope:"row"},on:{click:function(s){return e.insertFormat(t)}}},[e._v("\n            "+e._s(t)+"\n          ")])])})),0)])],2),e._v(" "),s("codemirror",{ref:"myCm",attrs:{value:e.customVar.code,options:e.cmOptions},on:{ready:e.onCmReady,focus:e.onCmFocus,input:e.onCmCodeChange}}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.customVar.code&&e.customVar.code.length,expression:"customVar.code && customVar.code.length"}],staticClass:"preview-var-wrapper"},[s("hr"),e._v(" "),s("button",{staticClass:"button-secondary",on:{click:e.previewCustomVar}},[e._v("\n      Preview\n    ")]),e._v(" "),s("span",[e._v("for line #")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.previewRecordIndex,expression:"previewRecordIndex"}],staticClass:"entry-length",attrs:{type:"number"},domProps:{value:e.previewRecordIndex},on:{input:function(t){t.target.composing||(e.previewRecordIndex=t.target.value)}}}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.customVarPreview&&e.customVarPreview.length,expression:"customVarPreview && customVarPreview.length"}],staticClass:"var-preview"},[s("button",{on:{click:function(t){e.customVarPreview=null}}},[e._v("\n        x\n      ")]),e._v("\n      "+e._s(e.customVarPreview)+"\n    ")])])],1)};C._withStripped=!0;var b=Object(c.a)(y,C,[],!1,null,null,null);b.options.__file="assets/src/components/StringEditor.vue";var x={name:"VarBuilder",components:{StepsRaw:g,StringEditor:b.exports},data:()=>({customVars:r.a.state.customVars,customVarPreview:"",store:r.a}),watch:{customVars:function(e){r.a.state.customVars=e}},methods:{addVar(e){r.a.commit("incrementVarId"),this.customVars.splice(e+1,0,{id:r.a.state.varIdCount,name:"Custom Var",code:""})},removeVar(e){this.customVars.splice(parseInt(e),1)}}},P=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("details",{staticClass:"ifm-var-builder",attrs:{open:""}},[s("summary",[e._v("\n    Complex Values\n  ")]),e._v(" "),e._l(e.customVars,(function(t,a){return s("details",{key:a,staticClass:"ifm-custom-var",attrs:{open:""}},[s("summary",{staticClass:"ifm-custom-var-wrapper",attrs:{open:""}},[s("div",{staticClass:"content-left"},[e._v("\n        "+e._s(t.name?t.name:"Unnamed Value")+"\n        "+e._s("("+t.id+")")+"\n      ")]),e._v(" "),e.customVars.length>1?s("button",{staticClass:"button button-primary",on:{click:function(t){return e.removeVar(a)}}},[e._v("\n        -\n      ")]):e._e(),e._v(" "),s("button",{staticClass:"button button-primary add-custom-value",on:{click:function(t){return e.addVar(a)}}},[e._v("\n        +\n      ")])]),e._v(" "),s("div",{staticClass:"custom-var-header"},[s("div",{staticClass:"ifm-params ifm-name"},[s("label",{attrs:{for:"varName"}},[e._v("Name")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"customVar.name"}],staticClass:"var-name",attrs:{type:"text",name:"varName"},domProps:{value:t.name},on:{input:function(s){s.target.composing||e.$set(t,"name",s.target.value)}}})])]),e._v(" "),s("StringEditor",{attrs:{index:a}})],1)})),e._v(" "),s("StepsRaw",{attrs:{open:!1,summary:"View Steps as Json"}})],2)};P._withStripped=!0;var I=Object(c.a)(x,P,[],!1,null,null,null);I.options.__file="assets/src/components/VarBuilder.vue";var S=I.exports,R={props:{parsedCsv:{type:Array,default:[]}},data:()=>({allSelected:!1,exampleEntries:1,exampleEntryLength:25,csvFields:r.a.state.csvFields}),mounted(){this.importLimit=this.parsedCsv.length-1},computed:{importOffset:{get:()=>parseInt(r.a.state.importOffset),set:e=>r.a.commit("updateOffset",parseInt(e))},importLimit:{get:()=>parseInt(r.a.state.importLimit),set:e=>r.a.commit("updateLimit",parseInt(e))}}},V=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("details",{attrs:{open:""}},[s("summary",[e._v("Import fields (pick some!)")]),e._v(" "),e.parsedCsv.length>0?s("span",{staticClass:"preview-details"},[e._v("\n    Previewing the first\n    "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.exampleEntryLength,expression:"exampleEntryLength"}],staticClass:"entry-length",attrs:{type:"number",name:"entryLength",min:"10"},domProps:{value:e.exampleEntryLength},on:{input:function(t){t.target.composing||(e.exampleEntryLength=t.target.value)}}}),e._v("\n    characters of\n    "),s("select",{directives:[{name:"model",rawName:"v-model",value:e.exampleEntries,expression:"exampleEntries"}],on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.exampleEntries=t.target.multiple?s:s[0]}}},e._l(e.parsedCsv.length-1,(function(t){return s("option",{key:t},[e._v(e._s(t))])})),0),e._v("\n    of "+e._s(parseInt(e.parsedCsv.length)-1)+" total Entries\n  ")]):e._e(),e._v(" "),s("div",{staticClass:"ifm-table-wrapper"},[s("table",{staticClass:"csv-table striped"},[s("tbody",[s("tr",[e._m(0),e._v(" "),e._l(e.parsedCsv[0],(function(t,a){return s("th",{key:a},[s("label",{attrs:{for:t}},[e._v(e._s(t)+" ("+e._s(a)+")")])])}))],2),e._v(" "),e._l(e.parsedCsv.slice(1,parseInt(e.exampleEntries)+1),(function(t,a){return s("tr",{key:a},[s("td",[e._v(e._s(a))]),e._v(" "),e._l(t,(function(t,a){return s("td",{key:a},[s("div",{staticClass:"cell-content",staticStyle:{height:"100%",width:"100%"}},[e._v("\n              "+e._s(t.substring(0,e.exampleEntryLength))+"\n            ")])])}))],2)}))],2)])]),e._v(" "),e.parsedCsv.length>0?s("span",{staticClass:"preview-details"},[e._v("\n    Start with record:\n    "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.importOffset,expression:"importOffset"}],staticClass:"import-offset",attrs:{type:"number",name:"importOffset",min:"0",max:e.parsedCsv.length-1},domProps:{value:e.importOffset},on:{input:function(t){t.target.composing||(e.importOffset=t.target.value)}}}),e._v("\n    End with record:\n    "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.importLimit,expression:"importLimit"}],staticClass:"import-limit",attrs:{type:"number",name:"importLimit",min:e.importOffset,max:e.parsedCsv.length-1},domProps:{value:e.importLimit},on:{input:function(t){t.target.composing||(e.importLimit=t.target.value)}}})]):e._e()])};V._withStripped=!0;var O=Object(c.a)(R,V,[function(){var e=this.$createElement,t=this._self._c||e;return t("th",[t("label",{attrs:{for:"select-all"}},[this._v("#")])])}],!1,null,null,null);O.options.__file="assets/src/components/CsvPreview.vue";var M=O.exports,k=(s(181),s(134)),F=(s(83),{name:"StepMapRow",props:["mapRow","stepIndex","mapIndex","action","params"],data:()=>({valueOptions:[],postTypes:["page","post","comment"],csvFields:r.a.state.csvFields}),created(){this.getPostTypes()},computed:{stepIds:function(){return r.a.getters.stepIds.slice(0,this.stepIndex-r.a.getters.stepIds.length)}},methods:{async getPostTypes(){const e=await o.WpApi.postTypes();this.postTypes=Object.values(e)},updateOptions(){let e=this.mapRow.type;delete this.mapRow.right,"postType"===e&&(this.valueOptions=this.postTypes.map(e=>({key:e,value:e}))),"csvValue"===e&&(this.valueOptions=this.csvFields.map(e=>({key:e,value:e}))),"stepId"===e&&(this.valueOptions=this.stepIds.map(e=>({key:e,value:e}))),"customVar"===e&&(this.valueOptions=r.a.getters.customVars)}}}),j=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"map-row"},[s("h2"),e._v(" "),s("div",{staticClass:"ifm-input-wrapper"},[s("label",{attrs:{for:"mapRowLeft"}},[e._v("Parameter")]),e._v(" "),null in e.params||"string"===e.mapRow.left?s("input",{directives:[{name:"model",rawName:"v-model",value:e.mapRow.left,expression:"mapRow.left"}],attrs:{type:"text",name:"mapRowLeft"},domProps:{value:e.mapRow.left},on:{input:function(t){t.target.composing||e.$set(e.mapRow,"left",t.target.value)}}}):s("select",{directives:[{name:"model",rawName:"v-model",value:e.mapRow.left,expression:"mapRow.left"}],attrs:{name:"mapRowLeft"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.mapRow,"left",t.target.multiple?s:s[0])}}},e._l(e.params,(function(t,a){return s("option",{key:a,domProps:{value:a}},[e._v("\n        "+e._s(t)+"\n      ")])})),0)]),e._v(" "),s("div",{staticClass:"equals"},[e._v("=")]),e._v(" "),s("div",{staticClass:"type-and-value"},[s("div",{staticClass:"ifm-input-wrapper"},[s("label",{attrs:{for:"mapRowType"}},[e._v("Type")]),e._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:e.mapRow.type,expression:"mapRow.type"}],attrs:{name:"mapRowType"},on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.mapRow,"type",t.target.multiple?s:s[0])},e.updateOptions]}},["post_type"===e.mapRow.left?s("option",{attrs:{value:"postType"}},[e._v("post type")]):e._e(),e._v(" "),s("option",{attrs:{value:"csvValue"}},[e._v("csv value")]),e._v(" "),e.stepIds.length>0?s("option",{attrs:{value:"stepId"}},[e._v("previous step")]):e._e(),e._v(" "),s("option",{attrs:{value:"string"}},[e._v("string")]),e._v(" "),s("option",{attrs:{value:"customVar"}},[e._v("complex value")])])]),e._v(" "),e.mapRow.type?s("div",{staticClass:"ifm-input-wrapper"},[s("label",{attrs:{for:"mapRowRight"}},[e._v("Value")]),e._v(" "),"string"!==e.mapRow.type?s("v-select",{attrs:{name:"mapRowRight",label:"key",index:"value",options:e.valueOptions},model:{value:e.mapRow.right,callback:function(t){e.$set(e.mapRow,"right",t)},expression:"mapRow.right"}}):s("input",{directives:[{name:"model",rawName:"v-model",value:e.mapRow.right,expression:"mapRow.right"}],attrs:{type:"text",name:"mapRowRight"},domProps:{value:e.mapRow.right},on:{input:function(t){t.target.composing||e.$set(e.mapRow,"right",t.target.value)}}})],1):e._e()])])};j._withStripped=!0;var E=Object(c.a)(F,j,[],!1,(function(e){s(345)}),null,null);E.options.__file="assets/src/components/stepper/StepMapRow.vue";var L={name:"ImportStep",props:["step","stepIndex"],components:{StepMapRow:E.exports},data:()=>({actions:[]}),created(){this.getActions()},computed:{action:function(){return this.actions.find(e=>this.step.action===e.id)},getMap:function(){return r.a.state.steps[this.stepIndex].getMap},setMap:function(){return r.a.state.steps[this.stepIndex].setMap}},methods:{async getActions(){const e=await Object(k.getActions)();this.actions=e},setPresets(e,t){void 0!==this.action&&r.a.commit("stepPresets",{index:e,getParams:this.action.getParams,setParams:this.action.setParams})},addMapRow(e){r.a.commit("addMapRow",{stepIndex:this.stepIndex,mapLength:e,isGetter:!1})},deleteMapRow(e){r.a.commit("deleteMapRow",{stepIndex:this.stepIndex,mapIndex:e,isGetter:!1})}}},T=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ifm-params"},[s("div",{staticClass:"ifm-define-action"},[s("h4",[e._v("Define Action")]),e._v(" "),s("div",{staticClass:"ifm-action-wrapper"},[s("div",{staticClass:"ifm-input-wrapper"},[s("v-select",{attrs:{options:e.actions,index:"id",label:"displayName"},on:{input:function(t){return e.setPresets(e.stepIndex,e.step.action)}},model:{value:e.step.action,callback:function(t){e.$set(e.step,"action",t)},expression:"step.action"}})],1)])]),e._v(" "),e.action&&e.action.getParams?s("div",{staticClass:"getters"},[s("h4",[e._v("Get By")]),e._v(" "),e._l(e.getMap,(function(t,a){return s("div",{key:a,staticClass:"ifm-input-group"},[s("StepMapRow",{attrs:{mapRow:t,stepIndex:e.stepIndex,mapIndex:a,action:e.action,params:e.action.getParams}})],1)}))],2):e._e(),e._v(" "),e.action&&e.action.setParams?s("div",{staticClass:"setters"},[s("h4",[e._v("Set Values")]),e._v(" "),e._l(e.setMap,(function(t,a){return s("div",{key:a,staticClass:"ifm-input-group"},[s("StepMapRow",{attrs:{mapRow:t,stepIndex:e.stepIndex,mapIndex:a,action:e.action,params:e.action.setParams}}),e._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:e.setMap.length>1,expression:"setMap.length > 1"}],staticClass:"delete-map-row button-secondary",on:{click:function(t){return e.deleteMapRow(a)}}},[e._v("\n        -\n      ")])],1)})),e._v(" "),""!==e.step.action?s("button",{staticClass:"button-secondary",on:{click:function(t){return e.addMapRow(e.setMap.length)}}},[e._v("\n      +\n    ")]):e._e()],2):e._e()])};T._withStripped=!0;var N=Object(c.a)(L,T,[],!1,null,null,null);N.options.__file="assets/src/components/stepper/ImportStep.vue";var U={name:"ImportSteps",components:{ImportStep:N.exports},data:()=>({steps:r.a.state.steps,actions:[]}),methods:{addStep(e){r.a.commit("addStep",e)},deleteStep(e){r.a.commit("removeStep",e)}}},A=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("details",{staticClass:"ifm-create-steps",attrs:{open:""}},[s("summary",[e._v("\n    Create Import Steps (runs on each CSV row)\n  ")]),e._v(" "),s("div",{staticClass:"ifm-steps-wrapper"},e._l(e.steps,(function(t,a){return s("details",{key:a,staticClass:"ifm-step",attrs:{open:""}},[s("summary",[s("span",{staticClass:"ifm-step-number"},[e._v("Step "+e._s(a+1))]),e._v(" "),s("span",{staticClass:"ifm-summary-right"},[s("span",{directives:[{name:"show",rawName:"v-show",value:t.action,expression:"step.action"}],staticClass:"ifm-step-name"},[e._v("\n            "+e._s(t.id)+"\n          ")]),e._v(" "),e.steps.length>1?s("button",{staticClass:"button button-primary",on:{click:function(t){return e.deleteStep(a)}}},[e._v("\n            -\n          ")]):e._e()])]),e._v(" "),s("ImportStep",{attrs:{step:t,stepIndex:a}}),e._v(" "),s("button",{staticClass:"button button-primary wide",on:{click:function(t){return e.addStep(a)}}},[e._v("\n        + Add Step\n      ")])],1)})),0)])};A._withStripped=!0;var $=Object(c.a)(U,A,[],!1,null,null,null);$.options.__file="assets/src/components/stepper/ImportSteps.vue";var D=$.exports,W=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"modal-mask"},[t("div",{staticClass:"modal-wrapper"},[t("div",{staticClass:"modal-container"},[t("div",{staticClass:"modal-header"},[this._t("header")],2),this._v(" "),t("div",{staticClass:"modal-body"},[this._t("body")],2),this._v(" "),t("div",{staticClass:"modal-footer"},[this._t("footer")],2)])])])};W._withStripped=!0;var H=Object(c.a)({},W,[],!1,null,null,null);H.options.__file="assets/src/components/ProgressModal.vue";var z={name:"Import",components:{FileUploader:d,ImportSteps:D,VarBuilder:S,CsvPreview:M,ProgressModal:H.exports},data:()=>({file:[],uploadObject:{},rawCsv:{},parsedCsv:[],inputValid:!0,progress:null,importComplete:!1,requestContent:"",showModal:!1,err:!1}),computed:{importLimit:()=>r.a.state.importLimit,csvFields:{get:()=>r.a.state.csvFields,set:e=>r.a.commit("updateCsvFields",e)},importState(){return this.importComplete?"Complete":this.err?this.err:"Pending"}},methods:{closeModal(){this.showModal=!1,this.progress=""},validateInput(){this.inputValid=!0},async handleImport(){this.showModal=!0,this.importComplete=!1,this.err=!1,this.runImport()},timeout:e=>new Promise(t=>setTimeout(t,e)),async getProgress(){for(;!1===this.importComplete&&!1===this.err;){let e=await o.WpApi.getProgress().auth();this.parseProgress(e),await this.timeout(200)}},parseProgress(e){(e=JSON.parse(e)).err&&(this.err=e.err),!1===this.importComplete&&(this.progress=e.progress)},async runImport(){try{let e=await o.WpApi.auth().runImport().param("upload_object",this.uploadObject).param("import_steps",r.a.getters.jsonSteps).param("import_vars",r.a.getters.jsonVars).param("offset",r.a.state.importOffset).param("limit",r.a.state.importLimit);this.parseProgress(e),this.importComplete=!0}catch(e){console.log(e.rawResponse),this.err=JSON.parse(e)}},async onUpload(e){r.a.commit("setFileId",e),await this.getObjectFromId(e),this.downloadFromUrl(this.uploadObject.guid.rendered),this.csvFields=[],r.a.commit("updateCsvFields",this.csvFields),this.allSelected=!1},async getObjectFromId(e){const t=await o.WpApi.media().id(e).get();this.uploadObject=t},async downloadFromUrl(e){n.a.get(e).then(e=>{this.rawCsv=e,this.parsedCsv=Object(p.CsvToArray)(e.data),r.a.commit("updateCsvFields",this.parsedCsv[0]),r.a.state.csvLength=this.parsedCsv.length})}}},Y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"import"},[s("FileUploader",{on:{uploaded:e.onUpload}}),e._v(" "),e.parsedCsv.length>1?s("CsvPreview",{attrs:{parsedCsv:e.parsedCsv}}):e._e(),e._v(" "),e.csvFields&&e.csvFields.length>0?s("div",[s("hr"),e._v(" "),s("div",{staticClass:"ifm-steps-and-vars"},[s("ImportSteps"),e._v(" "),s("div",{staticClass:"submit-wrapper"},[s("button",{staticClass:"button button-primary",attrs:{disabled:!e.inputValid},on:{click:e.handleImport}},[e._v("\n          Run Import\n        ")])])],1),e._v(" "),s("VarBuilder"),e._v(" "),e.showModal?s("ProgressModal",{on:{close:function(t){e.showModal=!1}},scopedSlots:e._u([{key:"body",fn:function(){return[s("details",{attrs:{open:""}},[s("summary",[e._v("Progress : "+e._s(e.importState)+" ")]),e._v(" "),s("div",{staticClass:"modal-details-body"},e._l(e.progress,(function(t,a){return s("div",{key:a,staticClass:"record-out"},[e._v("\n              "+e._s(Math.round(parseInt(a)/parseInt(e.importLimit)*100))+"% Record: "+e._s(parseInt(a))+"/"+e._s(parseInt(e.importLimit))+"\n              "),e._l(t,(function(t,a){return s("div",{key:a,class:{progress:!0,failed:!t.success}},[s("b",[e._v("Step id:")]),e._v(" "+e._s(t.id)+" "),s("b",[e._v("Success:")]),e._v("\n                "+e._s(t.success?"true":"false")+"\n                "),e._l(t.get,(function(a,r){return s("div",{directives:[{name:"show",rawName:"v-show",value:t.get,expression:"step.get"}],key:r},[s("b",[e._v("Get Parameter:")]),e._v(" "+e._s(r)+" "),s("b",[e._v("Value:")]),e._v(" "+e._s(a)+"\n                ")])})),e._v(" "),e._l(t.set,(function(a,r){return s("div",{directives:[{name:"show",rawName:"v-show",value:t.set,expression:"step.set"}],key:r},[s("b",[e._v("Set Parameter:")]),e._v(" "+e._s(r)+" "),s("b",[e._v("Value:")]),e._v(" "+e._s(a)+"\n                ")])}))],2)}))],2)})),0)])]},proxy:!0},{key:"footer",fn:function(){return[s("button",{staticClass:"button-primary",on:{click:e.closeModal}},[e._v("\n          x\n        ")])]},proxy:!0}],null,!1,1361995798)}):e._e()],1):e._e()],1)};Y._withStripped=!0;var q=Object(c.a)(z,Y,[],!1,null,null,null);q.options.__file="assets/src/router/routes/Import.vue",t.default=q.exports},338:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"ifm-importer-app"}},[t("h1",[this._v("Ifm Importer")]),this._v(" "),t("keep-alive",[t("router-view")],1)],1)};a._withStripped=!0;var r=s(3),i=Object(r.a)({name:"App"},a,[],!1,null,null,null);i.options.__file="assets/src/App.vue",t.default=i.exports},339:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"app-settings"},[this._v("\n    The Settings Page\n")])};a._withStripped=!0;var r=s(3),i=Object(r.a)({name:"Settings",data:()=>({})},a,[],!1,(function(e){s(347)}),"data-v-5ba0ed1b",null);i.options.__file="assets/src/router/routes/Settings.vue",t.default=i.exports},341:function(e,t){},345:function(e,t){},347:function(e,t){},57:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dateFormats=["Y-m-d","H:i:s","Y-m-d T H:i:s O","D, Y-m-d H:i:s O","l, Y-m-d H:i:s T","D, d M y H:i:s O","Y-m-dTH:i:sP","Y-m-dTH:i:s.vP","D, d M Y H:i:s O","Y-m-dTH:i:sP"],t.replaceExamples=[{name:"getDate",insert:'replace(date, "(d+)[-./](d+)[-./](d+)", "/1/2/3")',description:"Extract date from string"},{name:"getDate",insert:"getDate(date)",description:"Extract date from string"},{name:"getDate",insert:"getDate(date)",description:"Extract date from string"},{name:"getDate",insert:"getDate(date)",description:"Extract date from string"}],t.stringFunctions=[{name:"text",insert:'"text goes here"',description:"drop in some text"},{name:"toLower",insert:"toLower(input)",description:"make entire input lower case"},{name:"trim",insert:"trim(input)",description:"remove whitespace from either end of input"},{name:"toUpper",insert:"toUpper(input)",description:"make entire input uppercase"},{name:"humanize",insert:"humanize(input)",description:"Capitalizes the first word of the input, replaces underscores with spaces, and strips '_id'"},{name:"replace",insert:"replace(csv value, search, replacement)",description:"Replaces all occurrences of search in input by replacement"},{name:"htmlEncode",insert:"htmlEncode(input)",description:"Convert all applicable characters to HTML entities. An alias of htmlentities. "},{name:"htmlDecode",insert:"htmlDecode(input)",description:"Convert all HTML entities to their applicable characters."},{name:"titleize",insert:"titleize(input)",description:"Returns a trimmed string with the first letter of each word capitalized. Ignores connecting words"},{name:"formatDate",insert:"formatDate(date, dateFormat)",description:"Parses the date the best it knows how"}]},83:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.postMeta={post_id:"post id",meta_id:"meta id"},t.userMeta={user_id:"user id",meta_id:"meta id"};var a=t.getUser={ID:"user id"},r=t.getPost={ID:"post id"},i=(t.updateUser={user_pass:"user password",user_login:"username",user_nicename:"user nicename",user_url:"user url",user_email:"user email",display_name:"user display name",nickname:"user nickname",first_name:"user first name",last_name:"user last name",description:"user description",rich_editing:"rich editing",user_registered:"user registered",role:"role",jabber:"jabber",aim:"aim",yim:"yim",locale:"locale"},t.createUser={user_pass:"user password (required)",user_login:"username (required)",user_nicename:"user nicename",user_url:"user url",user_email:"user email (recommended)",display_name:"user display name",nickname:"user nickname",first_name:"user first name",last_name:"user last name",description:"user description",rich_editing:"rich editing",user_registered:"user registered",role:"role",jabber:"jabber",aim:"aim",yim:"yim",locale:"locale"}),n=t.createPost={post_author:"post author",post_name:"post name",post_type:"post type",post_title:"post title",post_date:"post date",post_date_gmt:"post date gmt",post_content:"post content",post_excerpt:"post excerpt",post_status:"post status",comment_status:"post comment status",ping_status:"ping status",post_password:"post password",post_parent:"post parent",post_modified:"last modified",post_modified_gmt:"last modified gmt",comment_count:"comment count",menu_order:"menu order"};t.params={getUser:a,getPost:r,createUser:i,createPost:n}},9:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=new(s(69))({username:"sam",password:"sam",endpoint:window.location.origin+"/wp-json",nonce:window.WP_API_Settings.nonce});a.importMethods=a.registerRoute("ifm/importer/v1","/methods"),a.myPosts=a.registerRoute("ifm/importer/v1","/author/(?P<id>)"),a.getCsv=a.registerRoute("ifm/importer/v1","/getcsv"),a.runImport=a.registerRoute("ifm/importer/v1","/run"),a.getProgress=a.registerRoute("ifm/importer/v1","/get-progress"),a.importParams=a.registerRoute("ifm/importer/v1","/get-params"),a.postTypes=a.registerRoute("ifm/importer/v1","/get-post-types"),a.acfFields=a.registerRoute("ifm/importer/v1","/get-acf-fields"),a.taxonomies=a.registerRoute("ifm/importer/v1","/get-taxonomies"),a.previewCustomVar=a.registerRoute("ifm/importer/v1","/preview-custom-var"),t.WpApi=a}});