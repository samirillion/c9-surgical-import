!function(e){function t(t){for(var s,i,l=t[0],o=t[1],p=t[2],u=0,d=[];u<l.length;u++)i=l[u],n[i]&&d.push(n[i][0]),n[i]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s]);for(c&&c(t);d.length;)d.shift()();return r.push.apply(r,p||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],s=!0,l=1;l<a.length;l++){var o=a[l];0!==n[o]&&(s=!1)}s&&(r.splice(t--,1),e=i(i.s=a[0]))}return e}var s={},n={2:0},r=[];function i(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=s,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(a,s,function(t){return e[t]}.bind(null,s));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var l=window.pluginWebpack=window.pluginWebpack||[],o=l.push.bind(l);l.push=t,l=l.slice();for(var p=0;p<l.length;p++)t(l[p]);var c=o;r.push([55,0]),a()}({10:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=new(a(28))({endpoint:"http://cea2.local/wp-json",nonce:window.WP_API_Settings.nonce});s.myPosts=s.registerRoute("ifm-importer/v1","/author/(?P<id>)"),s.getCsv=s.registerRoute("ifm-importer/v1","/getcsv"),s.runImport=s.registerRoute("ifm-importer/v1","/import-posts"),t.WpApi=s},11:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userParams=["user_pass","user_login","user_nicename","user_url","user_email","display_name","nickname","first_name","last_name","description","rich_editing","user_registered","role","jabber","aim","yim","locale"],t.postParams=["post_author","post_name","post_type","post_title","post_date","post_date_gmt","post_content","post_excerpt","post_status","comment_status","ping_status","post_password","post_parent","post_modified","post_modified_gmt","comment_count","menu_order"]},111:function(e,t,a){"use strict";a.r(t);var s=a(50),n=a.n(s),r=a(10),i=a(51),l={name:"FileUploader",props:["filetype","filedata"],data:()=>({file:{},uploadId:{},readyToSubmit:!1}),methods:{submitFile(){(new FormData).append("file",this.file);let e=this;r.WpApi.media().file(this.file).create({title:"CSV Upload",description:"Csv Upload for Import"}).then(function(t){e.$emit("uploaded",t.id)})},handleFileUpload(){this.file=this.$refs.file.files[0],this.readyToSubmit=!0}}},o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("label",[e._v("\n    Upload Your CSV\n    "),a("input",{ref:"file",staticClass:"file-upload",attrs:{type:"file"},on:{change:function(t){e.handleFileUpload()}}})]),e._v(" "),a("br"),e._v(" "),e.readyToSubmit?a("button",{staticClass:"button button-primary",on:{click:function(t){e.submitFile()}}},[e._v("Upload")]):e._e()])};o._withStripped=!0;var p=a(0),c=Object(p.a)(l,o,[],!1,null,null,null);c.options.__file="assets/src/shared/components/FileUploader.vue";var u=c.exports,d=a(11),v=a(2),m=a.n(v),_={name:"ParamMapper",props:["dbParams","inputFields","step"],data:()=>({map:{}}),methods:{mapParamValue(e,t){null===e?(delete this.map[t],m.a.updateStep(parseInt(this.step),this.map)):(this.map[t]=e,m.a.updateStep(parseInt(this.step),this.map))}}},f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",e._l(e.dbParams,function(t,s){return a("div",{key:s,staticClass:"param-to-field"},[a("v-select",{attrs:{options:e.inputFields,name:t},on:{input:function(a){e.mapParamValue(a,t)}}}),e._v(" "),a("label",{attrs:{for:t}},[e._v(e._s(t))])],1)}))};f._withStripped=!0;var h=Object(p.a)(_,f,[],!1,function(e){a(129)},"data-v-9b199750",null);h.options.__file="assets/src/admin/components/ParamMapper.vue";var b=h.exports,g={name:"MetaMapper",props:["inputFields","step"],data:()=>({meta:[{key:"",value:""}]}),methods:{updateKey(e,t){this.meta[t].key=e.target.value,m.a.updateStep(parseInt(this.step),this.meta)},updateValue(e,t){this.meta[t].value=e,m.a.updateStep(parseInt(this.step),this.meta)},addMeta(e,t){this.meta.splice(t+1,0,{key:"",value:""})},spliceMeta(e){this.meta.splice(e,1),m.a.updateStep(parseInt(this.step),this.meta)}}},y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"meta"},e._l(e.meta,function(t,s){return a("div",{key:s,staticClass:"single-meta"},[a("div",{staticClass:"key-row"},[a("b",[e._v("key:")]),e._v(" "),a("input",{staticClass:"meta-key-input",attrs:{type:"text"},domProps:{value:t.key},on:{input:function(t){e.updateKey(t,s)}}}),e._v(" "),e.meta.length>1?a("button",{on:{click:function(t){e.spliceMeta(e.step,s)}}},[e._v("-")]):e._e()]),e._v(" "),a("div",{staticClass:"value-row"},[a("b",[e._v("value:")]),e._v(" "),a("v-select",{staticStyle:{display:"inline-block"},attrs:{options:e.inputFields,value:t.value},on:{input:function(t){e.updateValue(t,s)}}}),e._v(" "),a("button",{on:{click:function(t){e.addMeta(e.step,s)}}},[e._v("+")])],1)])}))};y._withStripped=!0;var S=Object(p.a)(g,y,[],!1,null,null,null);S.options.__file="assets/src/admin/components/MetaMapper.vue";var k={name:"ImportSteps",components:{ParamMapper:b,MetaMapper:S.exports},props:["checkedFields"],data:()=>({postParams:d.postParams,userParams:d.userParams,steps:[{action:"",map:{}}],customFields:[]}),computed:{fields:function(){return this.checkedFields.concat(this.customFields)}},methods:{onParamUpdate:function(e){console.log(e)},stepPlusOne:function(e){return e+1},getParams:e=>"newPost"==e?d.postParams:"newUser"==e?d.userParams:void 0,addStep(e){this.steps.splice(e+1,0,{parent:null,action:"",map:{}})},deleteStep(e){this.steps.splice(e,1),m.a.removeStep(e)}}},w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"step-wrapper"},e._l(e.steps,function(t,s){return a("div",{key:s,staticClass:"step"},[a("h4",{staticClass:"step-name"},[e._v("Step "+e._s(e.stepPlusOne(s)))]),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.action,expression:"step.action"}],on:{change:function(a){var s=Array.prototype.filter.call(a.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(t,"action",a.target.multiple?s:s[0])}}},[a("option"),e._v(" "),a("option",{attrs:{value:"newPost"}},[e._v("create a post")]),e._v(" "),a("option",{attrs:{value:"newUser"}},[e._v("create a user")]),e._v(" "),0!==s?a("option",{attrs:{value:"addMeta"}},[e._v("add meta")]):e._e()]),e._v(" "),""!==t.action?a("button",{staticClass:"button button-primary",on:{click:function(t){e.addStep(s)}}},[e._v("+")]):e._e(),e._v(" "),e.steps.length>1?a("button",{staticClass:"button button-primary",on:{click:function(t){e.deleteStep(s)}}},[e._v("-")]):e._e(),e._v(" "),""!==t.action?a("span",[a("b",[e._v("then")])]):e._e(),e._v(" "),"addMeta"!==t.action?a("div",{staticClass:"post-params"},[a("ParamMapper",{attrs:{dbParams:e.getParams(t.action),inputFields:e.fields,step:s}})],1):"addMeta"==t.action?a("div",{staticClass:"add-meta"},[a("MetaMapper",{attrs:{inputFields:e.fields,step:s}})],1):e._e()])}))};w._withStripped=!0;var C=Object(p.a)(k,w,[],!1,null,null,null);C.options.__file="assets/src/admin/components/ImportSteps.vue";var P=C.exports,F={name:"VarBuilder",props:["baseFields"],data:()=>({nextSubVar:"field",customVars:[[]]}),methods:{addVar(e){this.customVars.splice(parseInt(e)+1,0,[[]])},removeVar(e){this.customVars.splice(parseInt(e),1)},addSubVar(e){console.log(e)},removeSubVar(e){console.log(e)}}},x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"custom-var-wrapper"},e._l(e.customVars,function(t,s){return a("div",{key:s,staticClass:"custom-var"},[a("label",{attrs:{for:"varName"}},[e._v("Variable Name")]),e._v(" "),a("input",{attrs:{type:"text",name:"varName"}}),e._v(" "),a("label",{attrs:{for:"addSubVar"}},[e._v("Add a:")]),e._v(" "),e._m(0,!0),e._v(" "),a("button",{on:{click:e.addSubVar}},[e._v("+")]),e._v(" "),a("br"),e._v("\n    "+e._s(t[0])+"\n    "),e._l(e.customVars[s],function(t,s){return a("div",{key:s},[e._v("\n      "+e._s(t.type)+"\n      "),a("br"),e._v(" "),a("input",{attrs:{type:"text"}}),e._v(" "),a("button",{on:{click:e.removeSubVar}},[e._v("-")])])}),e._v(" "),a("br",{attrs:{height:"0"}}),e._v(" "),a("button",{staticClass:"button button-primary",on:{click:function(t){e.addVar(s)}}},[e._v("+")]),e._v(" "),e.customVars.length>1?a("button",{staticClass:"button button-primary",on:{click:function(t){e.removeVar(s)}}},[e._v("-")]):e._e()],2)}))};x._withStripped=!0;var O=Object(p.a)(F,x,[function(){var e=this.$createElement,t=this._self._c||e;return t("select",{attrs:{name:"addSubVar"}},[t("option"),this._v(" "),t("option",{attrs:{value:"field"}},[this._v("Field")]),this._v(" "),t("option",{attrs:{value:"string"}},[this._v("String")]),this._v(" "),t("option",{attrs:{value:"string"}},[this._v("Regex")])])}],!1,null,null,null);O.options.__file="assets/src/admin/components/VarBuilder.vue";var j={name:"Import",components:{FileUploader:u,ImportSteps:P,VarBuilder:O.exports},data:()=>({allSelected:!1,file:[],uploadId:null,uploadObject:{},rawCsv:{},parsedCsv:[],checkedFields:[],exampleEntries:1,exampleEntryLength:25}),methods:{async runImport(){const e=await r.WpApi.runImport().param("import_maps",m.a.getSteps());console.log(e)},toggleSelect(){this.allSelected?this.checkedFields=this.parsedCsv[0]:this.checkedFields=[]},async onUpload(e){this.uploadId=e,m.a.setFileId(e),await this.getObjectFromId(e),this.downloadFromUrl(this.uploadObject.guid.rendered),this.checkedFields=[],this.allSelected=!1},async getObjectFromId(e){const t=await r.WpApi.media().id(e).get();this.uploadObject=t},async downloadFromUrl(e){n.a.get(e).then(e=>{this.rawCsv=e,this.parsedCsv=Object(i.CsvToArray)(e.data)})}}},M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"import"},[a("FileUploader",{on:{uploaded:e.onUpload}}),e._v(" "),e.parsedCsv.length>1?a("details",[a("summary",[e._v("Import fields")]),e._v(" "),a("div",{staticClass:"table-wrapper"},[a("table",{staticClass:"csv-table"},[a("tbody",[a("tr",[a("th",[a("label",{attrs:{for:"select-all"}},[e._v("Select all")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.allSelected,expression:"allSelected"}],attrs:{type:"checkbox",name:"select-all"},domProps:{checked:Array.isArray(e.allSelected)?e._i(e.allSelected,null)>-1:e.allSelected},on:{change:[function(t){var a=e.allSelected,s=t.target,n=!!s.checked;if(Array.isArray(a)){var r=e._i(a,null);s.checked?r<0&&(e.allSelected=a.concat([null])):r>-1&&(e.allSelected=a.slice(0,r).concat(a.slice(r+1)))}else e.allSelected=n},e.toggleSelect]}})]),e._v(" "),e._l(e.parsedCsv[0],function(t,s){return a("th",{key:s},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.checkedFields,expression:"checkedFields"}],attrs:{type:"checkbox",name:t},domProps:{value:t,checked:Array.isArray(e.checkedFields)?e._i(e.checkedFields,t)>-1:e.checkedFields},on:{change:function(a){var s=e.checkedFields,n=a.target,r=!!n.checked;if(Array.isArray(s)){var i=t,l=e._i(s,i);n.checked?l<0&&(e.checkedFields=s.concat([i])):l>-1&&(e.checkedFields=s.slice(0,l).concat(s.slice(l+1)))}else e.checkedFields=r}}}),e._v(" "),a("label",{attrs:{for:t}},[e._v(e._s(t)+" ("+e._s(s)+")")])])})],2),e._v(" "),e._l(e.parsedCsv.slice(1,parseInt(e.exampleEntries)+1),function(t,s){return a("tr",{key:s},[a("td"),e._v(" "),e._l(t,function(t,s){return a("td",{key:s},[a("div",{staticClass:"cell-content",staticStyle:{height:"100%",width:"100%"}},[e._v(e._s(t.substring(0,e.exampleEntryLength)))])])})],2)})],2)])]),e._v(" "),e.parsedCsv.length>0?a("span",{staticClass:"preview-details"},[e._v("\n      Previewing the first\n      "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.exampleEntryLength,expression:"exampleEntryLength"}],staticClass:"entry-length",attrs:{type:"number",name:"entryLength",min:"10"},domProps:{value:e.exampleEntryLength},on:{input:function(t){t.target.composing||(e.exampleEntryLength=t.target.value)}}}),e._v(" characters\n      "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.exampleEntries,expression:"exampleEntries"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.exampleEntries=t.target.multiple?a:a[0]}}},e._l(e.parsedCsv.length,function(t){return a("option",{key:t},[e._v(e._s(t))])})),e._v("\n      of "+e._s(e.parsedCsv.length)+" Entries\n    ")]):e._e()]):e._e(),e._v(" "),e.checkedFields.length>0?a("details",{staticClass:"custom-var-wrapper"},[a("summary",[e._v("Build Custom Variables")]),e._v(" "),a("VarBuilder")],1):e._e(),e._v(" "),e.checkedFields.length>0?a("details",{staticClass:"fields-wrapper"},[a("summary",[e._v("Variables ("+e._s(e.checkedFields.length)+")")]),e._v(" "),a("div",{staticClass:"import-fields-wrapper"},[a("ul",{staticClass:"import-fields"},e._l(e.checkedFields,function(t,s){return a("li",{key:s},[e._v("\n          "+e._s(t)+"\n          ")])}))])]):e._e(),e._v(" "),a("hr"),e._v(" "),a("details",{attrs:{open:""}},[a("summary",[e._v("Create Your Steps")]),e._v(" "),a("ImportSteps",{attrs:{checkedFields:e.checkedFields}})],1),e._v(" "),a("hr",{staticStyle:{clear:"both"}}),e._v(" "),a("div",{staticClass:"row"},[a("button",{staticClass:"button button-primary"},[e._v("Validate Input")]),e._v(" "),a("button",{staticClass:"button button-primary",on:{click:e.runImport}},[e._v("Run Import")])])],1)};M._withStripped=!0;var V=Object(p.a)(j,M,[],!1,null,null,null);V.options.__file="assets/src/admin/components/routes/Import.vue",t.default=V.exports},112:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"vue-backend-app"}},[t("h1",[this._v("Ifm Importer")]),this._v(" "),t("keep-alive",[t("router-view")],1)],1)};s._withStripped=!0;var n=a(0),r=Object(n.a)({name:"App"},s,[],!1,function(e){a(127)},null,null);r.options.__file="assets/src/admin/App.vue",t.default=r.exports},116:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"app-settings"},[this._v("\n    The Settings Page\n")])};s._withStripped=!0;var n=a(0),r=Object(n.a)({name:"Settings",data:()=>({})},s,[],!1,function(e){a(131)},"data-v-547321e8",null);r.options.__file="assets/src/admin/components/routes/Settings.vue",t.default=r.exports},127:function(e,t){},129:function(e,t){},131:function(e,t){},2:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:{uploadedFileId:[],steps:[]},getSteps:function(){return this.data},setFileId:function(e){this.data.uploadedFileId=e},removeStep:function(e){this.data.steps.splice(e,1)},addStep:function(e){this.data.steps.push(e)},updateStep:function(e,t){this.data.steps.splice(e,1,t),console.log(this.data)},addBaseFields:function(e,t){this.data.fields.push(t)}}},51:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CsvToArray=function(e,t){t=t||",";for(var a=new RegExp("(\\"+t+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+t+"\\r\\n]*))","gi"),s=[[]],n=null;n=a.exec(e);){var r,i=n[1];i.length&&i!==t&&s.push([]),r=n[2]?n[2].replace(new RegExp('""',"g"),'"'):n[3],s[s.length-1].push(r)}return s}},55:function(e,t,a){"use strict";var s=o(a(6)),n=o(a(112)),r=o(a(56)),i=o(a(96)),l=o(a(43));function o(e){return e&&e.__esModule?e:{default:e}}s.default.component("v-select",l.default),s.default.config.productionTip=!1,new s.default({el:"#vue-admin-app",router:r.default,render:function(e){return e(n.default)}}),(0,i.default)("ifm-importer")},56:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=l(a(6)),n=l(a(15)),r=l(a(111)),i=l(a(116));function l(e){return e&&e.__esModule?e:{default:e}}s.default.use(n.default),t.default=new n.default({routes:[{path:"/",name:"Import",component:r.default},{path:"/settings",name:"Settings",component:i.default}]})},96:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=jQuery,a=t("#toplevel_page_"+e),s=window.location.href,n=s.substr(s.indexOf("admin.php"));a.on("click","a",function(){var e=t(this);t("ul.wp-submenu li",a).removeClass("current"),e.hasClass("wp-has-submenu")?t("li.wp-first-item",a).addClass("current"):e.parents("li").addClass("current")}),t("ul.wp-submenu a",a).each(function(e,a){t(a).attr("href")!==n||t(a).parent().addClass("current")})}}});